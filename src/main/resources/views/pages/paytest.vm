#set($title = "Test Pay")

#*
<form method="post"  action="#springUrl("/pay/paytest")" name="paytest">

                <label >test pay</label>
                <div >

                    <span >价格：</span>
                    <input id="amount" type="text"  name="amount" value="10">
                    <input id="pay" type="submit"  value="pay">

                </div>



</form>

<br/>
<hr/>
<form method="post"  action="#springUrl("/pay/paytest_search")" name="paytest_search">
<label >test search</label>
<div >

    <input id="pay_search" type="submit"  value="search">

</div>

<link rel="stylesheet" type="text/css" href="/css/pinus.css">*#

<input id="action" type="hidden" value="#springUrl("http://localhost:9090/paytest")" >
<section class="block">
    <div class="content2">
        <div class="app">
             <label class="text_amount">
                 金 额: <input id="amount" type="text" value="1" />
            </label>
            <label class="text_amount">
                <input id="order" type="button" value="所有订单" onclick='window.location.href="#springUrl("/pay/paytest_search")"'/>
            </label>

            <div class="ch">
                <span class="up" onclick="wap_pay('upacp_wap')">银联 WAP</span>
                <span class="up" onclick="wap_pay('alipay_pc_direct')">支付宝</span>
                <span class="up" onclick="wap_pay('bfb_wap')">百度钱包 WAP</span>
                <span class="up" onclick="wap_pay('jdpay_wap')">京东支付 WAP</span>
                <span class="up" onclick="wap_pay('yeepay_wap')">易宝支付 WAP</span>
                <span class="up" onclick="wap_pay('wx_pub')">微信浏览器内公众号支付 WAP</span>
            </div>
        </div>
    </div>
</section>

#*<script>

    function wap_pay(channel) {
        var url = "http://localhost:9090/pay/paytest";

        var amount = document.getElementById('amount').value * 100;

        var xhr = new XMLHttpRequest();
        xhr.open("POST", url, true);
        xhr.setRequestHeader("Content-type", "application/json");
        xhr.send(JSON.stringify({
            channel: channel,
            amount: amount
        }));

        xhr.onreadystatechange = function () {
            if (xhr.readyState == 4 && xhr.status == 200) {
                console.log(xhr.responseText);
                alert(xhr.responseText);
                pingpp.createPayment(xhr.responseText, function(result, err) {
                    console.log(result);
                    console.log(err.msg);
                    console.log(err.extra);
                });
            }
        }
    }
</script>*#
<script src="/js/pingpp-pc.js" type="text/javascript"></script>
<script type="text/javascript">


    function wap_pay(channel){
        var amount = document.getElementById('amount').value * 100;
       // alert(amount);
        ajaxRequest({channel: channel, amount: amount});
    }
    function ajaxRequest(parameters) {
        var channel = parameters.channel;
        var amount = parameters.amount;
        $.ajax({
            url: "http://localhost:9090/pay/paytest",
            type: "POST",
            dataType: "json",
            data: {
                "channel": channel,
                "amount": amount
            },
            success: function(charge){
alert(charge);
                pingppPc.createPayment(charge, function(result, err){
                    console.log(result);
                    console.log(err.msg);
                    console.log(err.extra);
                });

            },
            error: function(XMLHttpRequest, textStatus, errorThrown) {

                alert(XMLHttpRequest.responseText);
                alert(XMLHttpRequest.status);
                alert(XMLHttpRequest.readyState);
                alert(textStatus); // parser error;

            }
        });
    }
</script>
